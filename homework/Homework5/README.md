# Домашнее задание - конвертация уже написанные тесты (на http и grpc) для отображения в allure

## Задание:

1. Добавить поддержку allure свои тесты (на http и grpc), которые вы делали в прошлых ДЗ и сделать прогон.
2. Посмотреть отчет с помощью `allure serve`, приложить его к MR.
3. "Поломать" тест и/или сервис, прогнать тесты еще раз и убедиться что ошибка есть в отчете. Тут идея в том, чтобы внести контролируемую ошибку и убедиться что вы видите ее в отчете причем в том месте годе ожидали. В идеале именно сервис, чтобы посмотреть как ошибки разработчика будут выглядеть в вашем отчете.
4. "Починить" все что поломали, проверить что тесты снова проходят :smile:
5. Прогнать тесты несколько раз подряд - убедиться, что не написали flacky тесты.

### Критерии приемки задания:

* 4 <= количество тестов <= 10
* 2 <= количество шагов в тесте <= 10
* в каждом тесте:
  * заголовок (Title)
  * описание (Description)
* хотя бы в одном тесте:
  * секция подготовки (TestSetup)
  * секция очистки (TestTeardown)
  * добавление вложения, например, ответ сервиса
* два архива с allure отчетами (успешный и с ошибкой)

## Задание со звездочкой

:gem: Сохранять результаты прогона в артефактах сборки.

:gem: Добавить в свои тесты работу с БД, например:

- В тесте UpdateDevice убедиться что изменения проливаются в БД, а не вернулись из кеша;
- В тесте RemoveDevice убедиться что запись осталась в БД;
- Написать тесты на `Add/Remove` `event` из `act-device-api/internal/app/repo/event`;
- свой вариант, сценарий можно сначала обсудить с тьютором.

:gem: Добавить в свои тесты работу с mock-ами, например:

- Сгенерировать mock репозитория и написать тесты на сервис, который работает с MockRepo, убедиться что тест проходит
  без поднятия сервиса.
- Написать тесты на `getMessageByDayTimeAndLeng` из `internal/model/notification`. Стоит переделать реализацию `DayTime`
  на автоопределение от `time.Now()` и засунуть в отдельный интерфейс. Тогда можно эмулировать разные `DayTime`.
- свой вариант, можно вообще свою функцию в которой есть random, привязка ко времени и
  т.д. сценарий можно сначала обсудить с тьютором.
